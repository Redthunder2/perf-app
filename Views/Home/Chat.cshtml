@{
    ViewData["Title"] = "Chat";
}

<div class="row h-100">
    <div class="col-md-8">
        <div class="card h-100">
            <div class="card-header">
                <h5>Video Chat</h5>
                <div class="btn-group" role="group">
                    <button type="button" class="btn btn-success" id="startCallBtn">Start Call</button>
                    <button type="button" class="btn btn-danger" id="endCallBtn" disabled>End Call</button>
                    <button type="button" class="btn btn-secondary" id="muteBtn">Mute</button>
                    <button type="button" class="btn btn-secondary" id="videoBtn">Video Off</button>
                </div>
            </div>
            <div class="card-body p-2">
                <div id="videoContainer" class="position-relative">
                    <video id="localVideo" class="local-video" autoplay muted></video>
                    <video id="remoteVideo" class="remote-video" autoplay></video>
                    <div id="connectionStatus" class="connection-status">
                        <span class="badge bg-secondary">Disconnected</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="card h-100">
            <div class="card-header">
                <h5>Text Chat</h5>
                <div class="user-info">
                    <small class="text-muted">Logged in as: <span id="currentUser">Guest</span></small>
                </div>
            </div>
            <div class="card-body d-flex flex-column">
                <div id="messagesList" class="flex-grow-1 overflow-auto mb-3"></div>
                <div class="input-group">
                    <input type="text" id="messageInput" class="form-control" placeholder="Type a message..." />
                    <button class="btn btn-primary" id="sendButton">Send</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="userModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Enter Your Name</h5>
            </div>
            <div class="modal-body">
                <input type="text" id="userInput" class="form-control" placeholder="Your name" />
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="joinChatBtn">Join Chat</button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/js/microsoft/signalr/dist/browser/signalr.js"></script>
    <script src="~/js/chat.js"></script>
}